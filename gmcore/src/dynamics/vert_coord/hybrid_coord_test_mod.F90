! ==============================================================================
! This file is part of GMCORE since 2019.
!
! GMCORE is a dynamical core for atmospheric model.
!
! GMCORE is distributed in the hope that it will be useful, but WITHOUT ANY
! WARRANTY. You may contact authors for helping or cooperation.
! ==============================================================================

module hybrid_coord_test_mod

  use flogger
  use const_mod
  use latlon_mesh_mod
  use latlon_parallel_types_mod

  implicit none

  private

  public hybrid_coord_test_l15
  public hybrid_coord_test_l15_2
  public hybrid_coord_test_l26
  public hybrid_coord_test_l30
  public hybrid_coord_wrf_l26
  public hybrid_coord_wrf_l32
  public hybrid_coord_wrf_l60
  public hybrid_coord_wrf_l64
  public hybrid_coord_schar_l40
  public hybrid_coord_dcmip21_l60
  public hybrid_coord_dcmip31_l10
  public hybrid_coord_waccm_l70
  public hybrid_coord_dcmip12
  public hybrid_coord_cam_l32
  public hybrid_coord_cam_l30

contains

  subroutine hybrid_coord_test_l15(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(16)
    real(r8), intent(out) :: hybi(16)

    if (global_mesh%full_nlev /= 15 .and. proc%is_root()) then
      call log_error('nlev should be 15 in namelist!')
    end if

    hyai = [                      &
      0.20548342556160501       , & !  1
      0.19860722202618653       , & !  2
      0.19102770905946154       , & !  3
      0.18269113232831347       , & !  4
      0.17354095565723510       , & !  5
      0.16351778267601666       , & !  6
      0.15255927802838637       , & !  7
      0.14060008814862757       , & !  8
      0.12757176161293954       , & !  9
      0.11340266907206642       , & ! 10
       9.8017922771487132E-002  , & ! 11
       8.1339295665243672E-002  , & ! 12
       6.3285140129278439E-002  , & ! 13
       4.3770306279956372E-002  , & ! 14
       2.2706059903264464E-002  , & ! 15
       0.0000000000000000         & ! 16
    ]
    hybi = [                      &
      0.0000000000000000        , & !  1
      3.3463543429963785E-002   , & !  2
      7.0349793238236480E-002   , & !  3
      0.11092034878724705       , & !  4
      0.15545034747726355       , & !  5
      0.20422884605360461       , & !  6
      0.25755920405050720       , & !  7
      0.31575946933746762       , & !  8
      0.37916276573512336       , & !  9
      0.44811768266892305       , & ! 10
      0.52298866682996359       , & ! 11
      0.60415641581341206       , & ! 12
      0.69201827370594826       , & ! 13
      0.78698862859460272       , & ! 14
      0.88949931197026377       , & ! 15
      1.0000000000000000          & ! 16
    ]

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_test_l15

  subroutine hybrid_coord_test_l15_2(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(16)
    real(r8), intent(out) :: hybi(16)

    if (global_mesh%full_nlev /= 15 .and. proc%is_root()) then
      call log_error('nlev should be 15 in namelist!')
    end if

    hyai = [               &
      0.20548342556160501, & !  1
      0.23095095671726124, & !  2
      0.25642840888903540, & !  3
      0.28130815734047598, & !  4
      0.30482649260369665, & !  5
      0.32603720716923434, & !  6
      0.34378173848776278, & !  7
      0.35665551500981602, & !  8
      0.36297012442815485, & !  9
      0.36071089422042385, & ! 10
      0.34748944396886805, & ! 11
      0.32049073671014727, & ! 12
      0.27641412269226595, & ! 13
      0.21140783333734559, & ! 14
      0.12099634587795560, & ! 15
      0.00000000000000000  & ! 16
    ]
    hybi = [                   &
      0.0000000000000000     , & !  1
      1.1198087388890725E-003, & !  2
      4.9490934086626227E-003, & !  3
      1.2303323775084538E-002, & !  4
      2.4164810530801977E-002, & !  5
      4.1709421560386935E-002, & !  6
      6.6336743591130801E-002, & !  7
      9.9704042476279162E-002, & !  8
      0.14376440291990805    , & !  9
      0.20080945752056562    , & ! 10
      0.27351714563258267    , & ! 11
      0.36500497476850846    , & ! 12
      0.47888929114296075    , & ! 13
      0.61935110153721351    , & ! 14
      0.79120902599557263    , & ! 15
      1.00000000000000000      & ! 16
    ]

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_test_l15_2

  subroutine hybrid_coord_test_l26(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(27)
    real(r8), intent(out) :: hybi(27)

    if (global_mesh%full_nlev /= 26 .and. proc%is_root()) then
      call log_error('nlev should be 26 in namelist!')
    end if

    hyai = [0.002194067  , & !  1
            0.004895209  , & !  2
            0.009882418  , & !  3
            0.01805201   , & !  4
            0.02983724   , & !  5
            0.04462334   , & !  6
            0.06160587   , & !  7
            0.07851243   , & !  8
            0.07731271   , & !  9
            0.07590131   , & ! 10
            0.07424086   , & ! 11
            0.07228744   , & ! 12
            0.06998933   , & ! 13
            0.06728574   , & ! 14
            0.06410509   , & ! 15
            0.06036322   , & ! 16
            0.05596111   , & ! 17
            0.05078225   , & ! 18
            0.04468960   , & ! 19
            0.03752191   , & ! 20
            0.02908949   , & ! 21
            0.02084739   , & ! 22
            0.01334443   , & ! 23
            0.00708499   , & ! 24
            0.00252136   , & ! 25
            0.00000000   , & ! 26
            0.00000000]      ! 27

    hybi = [0.000000     , & !  1
            0.000000     , & !  2
            0.000000     , & !  3
            0.000000     , & !  4
            0.000000     , & !  5
            0.000000     , & !  6
            0.000000     , & !  7
            0.000000     , & !  8
            0.01505309   , & !  9
            0.03276228   , & ! 10
            0.05359622   , & ! 11
            0.07810627   , & ! 12
            0.1069411    , & ! 13
            0.1408637    , & ! 14
            0.1807720    , & ! 15
            0.2277220    , & ! 16
            0.2829562    , & ! 17
            0.3479364    , & ! 18
            0.4243822    , & ! 19
            0.5143168    , & ! 20
            0.6201202    , & ! 21
            0.7235355    , & ! 22
            0.8176768    , & ! 23
            0.8962153    , & ! 24
            0.9534761    , & ! 25
            0.9851122    , & ! 26
            1.0000000]       ! 27

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_test_l26

  subroutine hybrid_coord_test_l30(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(31)
    real(r8), intent(out) :: hybi(31)

    if (global_mesh%full_nlev /= 30 .and. proc%is_root()) then
      call log_error('nlev should be 30 in namelist!')
    end if

    hyai = [                    &
      0.20548342556160501     , & !  1
      0.20212998435938231     , & !  2
      0.19860722202618653     , & !  3
      0.19490867458328423     , & !  4
      0.19102770905946154     , & !  5
      0.18695752105994870     , & !  6
      0.18269113232831347     , & !  7
      0.17822138830138046     , & !  8
      0.17354095565723510     , & !  9
      0.16864231985636818     , & ! 10
      0.16351778267601666     , & ! 11
      0.15815945973775417     , & ! 12
      0.15255927802838637     , & ! 13
      0.14670897341420119     , & ! 14
      0.14060008814862757     , & ! 15
      0.13422396837335138     , & ! 16
      0.12757176161293954     , & ! 17
      0.12063441426302013     , & ! 18
      0.11340266907206642     , & ! 19
      0.10586706261683282     , & ! 20
      9.8017922771487132E-002 , & ! 21
      8.9845366170487218E-002 , & ! 22
      8.1339295665243672E-002 , & ! 23
      7.2489397774615161E-002 , & ! 24
      6.3285140129278439E-002 , & ! 25
      5.3715768910014505E-002 , & ! 26
      4.3770306279956372E-002 , & ! 27
      3.3437547810834523E-002 , & ! 28
      2.2706059903264464E-002 , & ! 29
      1.1564177201115911E-002 , & ! 30
      0.0000000000000000        & ! 31
    ]
    hybi = [                    &
      0.0000000000000000      , & !  1
      1.6319764930224578E-002 , & !  2
      3.3463543429963785E-002 , & !  3
      5.1462792920738076E-002 , & !  4
      7.0349793238236480E-002 , & !  5
      9.0157658463320384E-002 , & !  6
      0.11092034878724705     , & !  7
      0.13267268241083147     , & !  8
      0.15545034747726355     , & !  9
      0.17928991403830608     , & ! 10
      0.20422884605360461     , & ! 11
      0.23030551342284719     , & ! 12
      0.25755920405050720     , & ! 13
      0.28603013594292515     , & ! 14
      0.31575946933746762     , & ! 15
      0.34678931886352893     , & ! 16
      0.37916276573512336     , & ! 17
      0.41292386997483987     , & ! 18
      0.44811768266892305     , & ! 19
      0.48479025825324623     , & ! 20
      0.52298866682996359     , & ! 21
      0.56276100651460537     , & ! 22
      0.60415641581341206     , & ! 23
      0.64722508603068596     , & ! 24
      0.69201827370594826     , & ! 25
      0.73858831308070516     , & ! 26
      0.78698862859460272     , & ! 27
      0.83727374741078686     , & ! 28
      0.88949931197026377     , & ! 29
      0.94372209257505824     , & ! 30
      1.0000000000000000        & ! 31
    ]

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_test_l30

  subroutine hybrid_coord_wrf_l26(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(in ) :: ptop
    real(r8), intent(out) :: hyai(27)
    real(r8), intent(out) :: hybi(27)

    if (global_mesh%full_nlev /= 26 .and. proc%is_root()) then
      call log_error('nlev should be 26 in namelist!')
    end if

    hyai = [              &
      0.0000000000000000, & !  1
      0.0026949368990385, & !  2
      0.0076765830700214, & !  3
      0.0158441481359590, & !  4
      0.0276273570916710, & !  5
      0.0414422617493396, & !  6
      0.0562280278845174, & !  7
      0.0724791367109593, & !  8
      0.0893764691932271, & !  9
      0.1063516039069875, & ! 10
      0.1254699736141626, & ! 11
      0.1479612378540120, & ! 12
      0.1744206867899481, & ! 13
      0.2054467443488705, & ! 14
      0.2362331354387115, & ! 15
      0.2617244861517879, & ! 16
      0.2783056303113054, & ! 17
      0.2816242061994436, & ! 18
      0.2669746497908253, & ! 19
      0.2303286706439434, & ! 20
      0.1705682721867309, & ! 21
      0.1064887571082237, & ! 22
      0.0535041093004280, & ! 23
      0.0199854375869117, & ! 24
      0.0049141727575007, & ! 25
      0.0008271366689887, & ! 26
      0.0000000000000000  & ! 27
    ]
    hybi = [              &
      0.0000000000000000, & !  1
      0.0000000000000000, & !  2
      0.0000000000000000, & !  3
      0.0000000000000000, & !  4
      0.0000000000000000, & !  5
      0.0000000000000000, & !  6
      0.0000000000000000, & !  7
      0.0000000000000000, & !  8
      0.0000000000000000, & !  9
      0.0000000000000000, & ! 10
      0.0000000000000000, & ! 11
      0.0000000000000000, & ! 12
      0.0000000000000000, & ! 13
      0.0001055707738109, & ! 14
      0.0059372955912098, & ! 15
      0.0235354910761884, & ! 16
      0.0576432893794934, & ! 17
      0.1139595353789115, & ! 18
      0.1987640251563301, & ! 19
      0.3179517452840197, & ! 20
      0.4748134785123594, & ! 21
      0.6338019812807031, & ! 22
      0.7731855115963033, & ! 23
      0.8787837382816079, & ! 24
      0.9464020881646360, & ! 25
      0.9795195430185113, & ! 26
      1.0000000000000000  & ! 27
    ]

  end subroutine hybrid_coord_wrf_l26

  subroutine hybrid_coord_wrf_l32(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(in ) :: ptop
    real(r8), intent(out) :: hyai(33)
    real(r8), intent(out) :: hybi(33)

    if (global_mesh%full_nlev /= 32 .and. proc%is_root()) then
      call log_error('nlev should be 32 in namelist!')
    end if

    hyai = [              &
      0.0000000000000000, & !  1
      0.0027008056640625, & !  2
      0.0076868347823620, & !  3
      0.0158526937798342, & !  4
      0.0276367470939261, & !  5
      0.0414515552099706, & !  6
      0.0562277844155789, & !  7
      0.0724737972365225, & !  8
      0.0893795253309864, & !  9
      0.1063548465048298, & ! 10
      0.1254725257849640, & ! 11
      0.1479642011314251, & ! 12
      0.1744233770857367, & ! 13
      0.2054476619883455, & ! 14
      0.2362396334209435, & ! 15
      0.2617261684535087, & ! 16
      0.2783057827853432, & ! 17
      0.2816243248017372, & ! 18
      0.2683280168286641, & ! 19
      0.2429473354807992, & ! 20
      0.2108099294331058, & ! 21
      0.1759998110016148, & ! 22
      0.1415334037742616, & ! 23
      0.1095123294032484, & ! 24
      0.0812761592574764, & ! 25
      0.0575423961814687, & ! 26
      0.0385285881906738, & ! 27
      0.0240694984015316, & ! 28
      0.0137226170696702, & ! 29
      0.0068720184783044, & ! 30
      0.0027973066609278, & ! 31
      0.0007580797514921, & ! 32
      0.0000000000000000  & ! 33
    ]
    hybi = [              &
      0.0000000000000000, & !  1
      0.0000000000000000, & !  2
      0.0000000000000000, & !  3
      0.0000000000000000, & !  4
      0.0000000000000000, & !  5
      0.0000000000000000, & !  6
      0.0000000000000000, & !  7
      0.0000000000000000, & !  8
      0.0000000000000000, & !  9
      0.0000000000000000, & ! 10
      0.0000000000000000, & ! 11
      0.0000000000000000, & ! 12
      0.0000000000000000, & ! 13
      0.0001056069805219, & ! 14
      0.0059397906834944, & ! 15
      0.0235374270991938, & ! 16
      0.0576439176162314, & ! 17
      0.1139578493851603, & ! 18
      0.1932313936022966, & ! 19
      0.2808764820852269, & ! 20
      0.3715629284436812, & ! 21
      0.4612091687348547, & ! 22
      0.5467954414732804, & ! 23
      0.6262219272258057, & ! 24
      0.6981497395977654, & ! 25
      0.7618575996945027, & ! 26
      0.8171268253424389, & ! 27
      0.8641240158900223, & ! 28
      0.9032994538662682, & ! 29
      0.9352560448161740, & ! 30
      0.9607227915792738, & ! 31
      0.9804356127137464, & ! 32
      1.0000000000000000  & ! 33
    ]

  end subroutine hybrid_coord_wrf_l32

  subroutine hybrid_coord_wrf_l60(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(in ) :: ptop
    real(r8), intent(out) :: hyai(61)
    real(r8), intent(out) :: hybi(61)

    if (global_mesh%full_nlev /= 60 .and. proc%is_root()) then
      call log_error('nlev should be 60 in namelist!')
    end if

    hyai = [ &
      0.0000000000000000, 0.0166666666666667, 0.0333333333333333, &
      0.0500000000000000, 0.0666666666666667, 0.0833333333333333, &
      0.1000000000000000, 0.1166666666666667, 0.1333333333333333, &
      0.1500000000000000, 0.1666666666666667, 0.1833333333333333, &
      0.2000000000000000, 0.2157226562500000, 0.2296006944444444, &
      0.2416992187500000, 0.2520833333333333, 0.2608181423611111, &
      0.2679687500000000, 0.2736002604166666, 0.2777777777777778, &
      0.2805664062500000, 0.2820312500000000, 0.2822374131944445, &
      0.2812500000000000, 0.2791341145833334, 0.2759548611111111, &
      0.2717773437500000, 0.2666666666666667, 0.2606879340277780, &
      0.2539062500000000, 0.2463867187500000, 0.2381944444444444, &
      0.2293945312500000, 0.2200520833333336, 0.2102322048611110, &
      0.2000000000000000, 0.1894205729166667, 0.1785590277777778, &
      0.1674804687499999, 0.1562500000000000, 0.1449327256944448, &
      0.1335937500000000, 0.1222981770833331, 0.1111111111111114, &
      0.1000976562500000, 0.0893229166666668, 0.0788519965277780, &
      0.0687499999999999, 0.0590820312500000, 0.0499131944444443, &
      0.0413085937500000, 0.0333333333333337, 0.0260525173611112, &
      0.0195312500000000, 0.0138346354166669, 0.0090277777777781, &
      0.0051757812500000, 0.0023437500000000, 0.0005967881944450, &
      0.0000000000000000 &
    ]
    hybi = [ &
      0.0000000000000000, 0.0000000000000000, 0.0000000000000000, &
      0.0000000000000000, 0.0000000000000000, 0.0000000000000000, &
      0.0000000000000000, 0.0000000000000000, 0.0000000000000000, &
      0.0000000000000000, 0.0000000000000000, 0.0000000000000000, &
      0.0000000000000000, 0.0009440104166667, 0.0037326388888889, &
      0.0083007812500000, 0.0145833333333334, 0.0225151909722222, &
      0.0320312500000000, 0.0430664062500000, 0.0555555555555555, &
      0.0694335937499999, 0.0846354166666666, 0.1010959201388889, &
      0.1187500000000000, 0.1375325520833333, 0.1573784722222222, &
      0.1782226562499999, 0.2000000000000000, 0.2226453993055554, &
      0.2460937499999999, 0.2702799479166667, 0.2951388888888889, &
      0.3206054687499998, 0.3466145833333331, 0.3731011284722224, &
      0.4000000000000000, 0.4272460937500000, 0.4547743055555555, &
      0.4825195312500001, 0.5104166666666665, 0.5384006076388885, &
      0.5664062499999998, 0.5943684895833335, 0.6222222222222219, &
      0.6499023437500000, 0.6773437499999999, 0.7044813368055554, &
      0.7312500000000002, 0.7575846354166664, 0.7834201388888891, &
      0.8086914062499995, 0.8333333333333330, 0.8572808159722221, &
      0.8804687499999999, 0.9028320312499998, 0.9243055555555553, &
      0.9448242187499996, 0.9643229166666663, 0.9827365451388883, &
      1.0000000000000000 &
    ]

  end subroutine hybrid_coord_wrf_l60

  subroutine hybrid_coord_dcmip12(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(:)
    real(r8), intent(out) :: hybi(:)
    real(r8), parameter :: ztop = 12000
    real(r8), parameter :: t0   = 300
    real(r8) eta_top, deta, eta
    integer k

    ptop = p0 * exp(-g * ztop / rd / t0)
    eta_top = ptop / p0
    deta = (1 - eta_top) / global_mesh%full_nlev
    do k = 1, global_mesh%half_nlev
      eta = eta_top + (k - 1) * deta
      hyai(k) = eta
      hybi(k) = 0
    end do

  end subroutine hybrid_coord_dcmip12

  subroutine hybrid_coord_wrf_l64(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(in ) :: ptop
    real(r8), intent(out) :: hyai(65)
    real(r8), intent(out) :: hybi(65)

    if (global_mesh%full_nlev /= 64 .and. proc%is_root()) then
      call log_error('nlev should be 64 in namelist!')
    end if

    hyai = [          &
      0.00000000e+00, & !  1
      1.56250000e-02, & !  2
      3.12500000e-02, & !  3
      4.68750000e-02, & !  4
      6.25000000e-02, & !  5
      7.81250000e-02, & !  6
      9.37500000e-02, & !  7
      1.09375000e-01, & !  8
      1.25000000e-01, & !  9
      1.40625000e-01, & !  10
      1.56250000e-01, & !  11
      1.71875000e-01, & !  12
      1.87500000e-01, & !  13
      2.03091502e-01, & !  14
      2.17556953e-01, & !  15
      2.30408311e-01, & !  16
      2.41699219e-01, & !  17
      2.51483321e-01, & !  18
      2.59814262e-01, & !  19
      2.66745687e-01, & !  20
      2.72331238e-01, & !  21
      2.76624560e-01, & !  22
      2.79679298e-01, & !  23
      2.81549096e-01, & !  24
      2.82287598e-01, & !  25
      2.81948447e-01, & !  26
      2.80585289e-01, & !  27
      2.78251767e-01, & !  28
      2.75001526e-01, & !  29
      2.70888209e-01, & !  30
      2.65965462e-01, & !  31
      2.60286927e-01, & !  32
      2.53906250e-01, & !  33
      2.46877074e-01, & !  34
      2.39253044e-01, & !  35
      2.31087804e-01, & !  36
      2.22434998e-01, & !  37
      2.13348269e-01, & !  38
      2.03881264e-01, & !  39
      1.94087625e-01, & !  40
      1.84020996e-01, & !  41
      1.73735023e-01, & !  42
      1.63283348e-01, & !  43
      1.52719617e-01, & !  44
      1.42097473e-01, & !  45
      1.31470561e-01, & !  46
      1.20892525e-01, & !  47
      1.10417008e-01, & !  48
      1.00097656e-01, & !  49
      8.99881124e-02, & !  50
      8.01420212e-02, & !  51
      7.06130266e-02, & !  52
      6.14547729e-02, & !  53
      5.27209044e-02, & !  54
      4.44650650e-02, & !  55
      3.67408991e-02, & !  56
      2.96020508e-02, & !  57
      2.31021643e-02, & !  58
      1.72948837e-02, & !  59
      1.22338533e-02, & !  60
      7.97271729e-03, & !  61
      4.56511974e-03, & !  62
      2.06470490e-03, & !  63
      5.25116920e-04, & !  64
      4.44089210e-16  & !  65
    ]
    hybi = [          &
      0.00000000e+00, & !  1
      0.00000000e+00, & !  2
      0.00000000e+00, & !  3
      0.00000000e+00, & !  4
      0.00000000e+00, & !  5
      0.00000000e+00, & !  6
      0.00000000e+00, & !  7
      0.00000000e+00, & !  8
      0.00000000e+00, & !  9
      0.00000000e+00, & !  10
      0.00000000e+00, & !  11
      0.00000000e+00, & !  12
      0.00000000e+00, & !  13
      3.34978104e-05, & !  14
      1.19304657e-03, & !  15
      3.96668911e-03, & !  16
      8.30078125e-03, & !  17
      1.41416788e-02, & !  18
      2.14357376e-02, & !  19
      3.01293135e-02, & !  20
      4.01687622e-02, & !  21
      5.15004396e-02, & !  22
      6.40707016e-02, & !  23
      7.78259039e-02, & !  24
      9.27124023e-02, & !  25
      1.08676553e-01, & !  26
      1.25664711e-01, & !  27
      1.43623233e-01, & !  28
      1.62498474e-01, & !  29
      1.82236791e-01, & !  30
      2.02784538e-01, & !  31
      2.24088073e-01, & !  32
      2.46093750e-01, & !  33
      2.68747926e-01, & !  34
      2.91996956e-01, & !  35
      3.15787196e-01, & !  36
      3.40065002e-01, & !  37
      3.64776731e-01, & !  38
      3.89868736e-01, & !  39
      4.15287375e-01, & !  40
      4.40979004e-01, & !  41
      4.66889977e-01, & !  42
      4.92966652e-01, & !  43
      5.19155383e-01, & !  44
      5.45402527e-01, & !  45
      5.71654439e-01, & !  46
      5.97857475e-01, & !  47
      6.23957992e-01, & !  48
      6.49902344e-01, & !  49
      6.75636888e-01, & !  50
      7.01107979e-01, & !  51
      7.26261973e-01, & !  52
      7.51045227e-01, & !  53
      7.75404096e-01, & !  54
      7.99284935e-01, & !  55
      8.22634101e-01, & !  56
      8.45397949e-01, & !  57
      8.67522836e-01, & !  58
      8.88955116e-01, & !  59
      9.09641147e-01, & !  60
      9.29527283e-01, & !  61
      9.48559880e-01, & !  62
      9.66685295e-01, & !  63
      9.83849883e-01, & !  64
      1.00000000e+00  & !  65
    ]

  end subroutine hybrid_coord_wrf_l64

  subroutine hybrid_coord_schar_l40(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(41)
    real(r8), intent(out) :: hybi(41)

    if (global_mesh%full_nlev /= 40 .and. proc%is_root()) then
      call log_error('nlev should be 40 in namelist!')
    end if

    hyai = [                  &
      0.1025039799580591_r8 , & !  1
      0.1018179561734005_r8 , & !  2
      0.1010917320769832_r8 , & !  3
      0.1003229519705039_r8 , & !  4
      0.09950912211408078_r8, & !  5
      0.09864760263715414_r8, & !  6
      0.09773559897537391_r8, & !  7
      0.0967701528056974_r8 , & !  8
      0.09574813245029265_r8, & !  9
      0.0946662227181202_r8 , & ! 10
      0.09352091415124149_r8, & ! 11
      0.09230849164097177_r8, & ! 12
      0.09102502237695081_r8, & ! 13
      0.08966634309004112_r8, & ! 14
      0.0882280465476728_r8 , & ! 15
      0.08670546725782877_r8, & ! 16
      0.08509366633529811_r8, & ! 17
      0.08338741548110656_r8, & ! 18
      0.08158118002315787_r8, & ! 19
      0.0796691009630732_r8 , & ! 20
      0.07764497597099371_r8, & ! 21
      0.07550223926669675_r8, & ! 22
      0.07323394032176639_r8, & ! 23
      0.0708327213137312_r8 , & ! 24
      0.06829079325903814_r8, & ! 25
      0.0655999107474412_r8 , & ! 26
      0.06275134519585163_r8, & ! 27
      0.059735856534889_r8  , & ! 28
      0.05654366323629351_r8, & ! 29
      0.05316441058397392_r8, & ! 30
      0.04958713708577023_r8, & ! 31
      0.04580023891697926_r8, & ! 32
      0.0417914322803068_r8 , & ! 33
      0.03754771356014897_r8, & ! 34
      0.03305531714195531_r8, & ! 35
      0.02829967075984829_r8, & ! 36
      0.0232653482276568_r8 , & ! 37
      0.01793601940003686_r8, & ! 38
      0.01229439720136161_r8, & ! 39
      0.006322181550559192_r8,& ! 40
      0.00000000000000000_r8  & ! 41
    ]
    hybi = [                  &
      0.00000000000000000_r8, &
      0.006692655104117077_r8,&
      0.01377749314371797_r8, &
      0.02127749564892662_r8, &
      0.0292169908446848_r8 , &
      0.03762173256572957_r8, &
      0.04651898379590992_r8, &
      0.05593760510282444_r8, &
      0.06590814825464078_r8, &
      0.07646295532276762_r8, &
      0.08763626359184486_r8, &
      0.09946431661735464_r8, &
      0.1119854817910982_r8 , &
      0.1252403747958928_r8 , &
      0.1392719913531897_r8 , &
      0.1541258466909729_r8 , &
      0.169850123184336_r8  , &
      0.186495826647652_r8  , &
      0.2041169517853076_r8 , &
      0.2227706573376872_r8 , &
      0.2425174514905357_r8 , &
      0.2634213881491285_r8 , &
      0.2855502747139088_r8 , &
      0.3089758920315744_r8 , &
      0.3337742272350772_r8 , &
      0.3600257202278167_r8 , &
      0.38781552461156_r8   , &
      0.4172337839044817_r8 , &
      0.4483759239453033_r8 , &
      0.4813429624320262_r8 , &
      0.5162418365993261_r8 , &
      0.5531857500975178_r8 , &
      0.5922945401982802_r8 , &
      0.6336950665182751_r8 , &
      0.6775216225215809_r8 , &
      0.7239163711357605_r8 , &
      0.773029805894599_r8  , &
      0.8250212391033444_r8 , &
      0.8800593186099503_r8 , &
      0.9383225748585959_r8 , &
      1.0000000000000000_r8   &
    ]

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_schar_l40

  subroutine hybrid_coord_dcmip21_l60(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(61)
    real(r8), intent(out) :: hybi(61)

    if (global_mesh%full_nlev /= 60 .and. proc%is_root()) then
      call log_error('nlev should be 60 in namelist!')
    end if

    hyai = [                   &
      0.03281792304784018_r8 , & !  1
      0.03474102071194446_r8 , & !  2
      0.03677680998728482_r8 , & !  3
      0.03893189449024544_r8 , & !  4
      0.04121326480256544_r8 , & !  5
      0.04362832114712411_r8 , & !  6
      0.04618489739250437_r8 , & !  7
      0.04889128646419994_r8 , & !  8
      0.05175626724489389_r8 , & !  9
      0.0547891330510669_r8  , & ! 10
      0.05799972177830628_r8 , & ! 11
      0.06139844781310023_r8 , & ! 12
      0.06499633581463152_r8 , & ! 13
      0.06880505647615068_r8 , & ! 14
      0.07283696438193012_r8 , & ! 15
      0.07710513808259807_r8 , & ! 16
      0.08162342251884733_r8 , & ! 17
      0.08640647393113107_r8 , & ! 18
      0.09146980740102234_r8 , & ! 19
      0.09682984717844971_r8 , & ! 20
      0.1025039799580591_r8  , & ! 21
      0.1085106112775176_r8  , & ! 22
      0.1148692252207011_r8  , & ! 23
      0.1216004476194305_r8  , & ! 24
      0.1287261129587656_r8  , & ! 25
      0.1350456081805054_r8  , & ! 26
      0.1427250473547907_r8  , & ! 27
      0.1508030763969775_r8  , & ! 28
      0.1592924802031636_r8  , & ! 29
      0.1682047034916206_r8  , & ! 30
      0.1775493685725172_r8  , & ! 31
      0.1873336879076161_r8  , & ! 32
      0.1975617507483634_r8  , & ! 33
      0.2082336591917547_r8  , & ! 34
      0.219344484300267_r8   , & ! 35
      0.2308830073555085_r8  , & ! 36
      0.2428302046894931_r8  , & ! 37
      0.2551574266661043_r8  , & ! 38
      0.267824212035116_r8   , & ! 39
      0.2807756677752939_r8  , & ! 40
      0.2939393313530507_r8  , & ! 41
      0.3072214166589859_r8  , & ! 42
      0.3205023262836642_r8  , & ! 43
      0.3336312907070463_r8  , & ! 44
      0.346419968751406_r8   , & ! 45
      0.3586348125120132_r8  , & ! 46
      0.3699879630156528_r8  , & ! 47
      0.3801263989752005_r8  , & ! 48
      0.388619008916789_r8   , & ! 49
      0.3949411951212309_r8  , & ! 50
      0.3984565444238701_r8  , & ! 51
      0.398395013798003_r8   , & ! 52
      0.3938269752447859_r8  , & ! 53
      0.3836323417875858_r8  , & ! 54
      0.3664638507145668_r8  , & ! 55
      0.3407034073507749_r8  , & ! 56
      0.3044101874928628_r8  , & ! 57
      0.2552589531818032_r8  , & ! 58
      0.1904667475740021_r8  , & ! 59
      0.106705791818907_r8   , & ! 60
      0.0_r8                   & ! 61
    ]
    hybi = [                   &
      0.0_r8                 , & !  1
      0.0_r8                 , & !  2
      0.0_r8                 , & !  3
      0.0_r8                 , & !  4
      0.0_r8                 , & !  5
      0.0_r8                 , & !  6
      0.0_r8                 , & !  7
      0.0_r8                 , & !  8
      0.0_r8                 , & !  9
      0.0_r8                 , & ! 10
      0.0_r8                 , & ! 11
      0.0_r8                 , & ! 12
      0.0_r8                 , & ! 13
      0.0_r8                 , & ! 14
      0.0_r8                 , & ! 15
      0.0_r8                 , & ! 16
      0.0_r8                 , & ! 17
      0.0_r8                 , & ! 18
      0.0_r8                 , & ! 19
      0.0_r8                 , & ! 20
      0.0_r8                 , & ! 21
      0.0_r8                 , & ! 22
      0.0_r8                 , & ! 23
      0.0_r8                 , & ! 24
      0.0_r8                 , & ! 25
      0.001223727022378311_r8, & ! 26
      0.001529535416493121_r8, & ! 27
      0.001904681511544389_r8, & ! 28
      0.002363800501769887_r8, & ! 29
      0.002924474549267209_r8, & ! 30
      0.003607809170569179_r8, & ! 31
      0.004439120350710344_r8, & ! 32
      0.005448753419685578_r8, & ! 33
      0.006673058694179184_r8, & ! 34
      0.008155553600595522_r8, & ! 35
      0.00994830659329325_r8 , & ! 36
      0.01211358483014104_r8 , & ! 37
      0.0147258154626543_r8  , & ! 38
      0.01787391977334953_r8 , & ! 39
      0.0216640905254665_r8  , & ! 40
      0.02622309610847879_r8 , & ! 41
      0.03170221075683934_r8 , & ! 42
      0.03828188875201099_r8 , & ! 43
      0.04617732263825928_r8 , & ! 44
      0.05564505174270933_r8 , & ! 45
      0.06699081846324466_r8 , & ! 46
      0.08057890679175883_r8 , & ! 47
      0.09684324146417017_r8 , & ! 48
      0.1163005782648078_r8  , & ! 49
      0.1395661778947692_r8  , & ! 50
      0.1673724292612262_r8  , & ! 51
      0.200590975216494_r8   , & ! 52
      0.2402589972338011_r8  , & ! 53
      0.2876104382908383_r8  , & ! 54
      0.3441130889489694_r8  , & ! 55
      0.4115126345448339_r8  , & ! 56
      0.491884966629393_r8   , & ! 57
      0.587698305321578_r8   , & ! 58
      0.7018869682373099_r8  , & ! 59
      0.8379389645902481_r8  , & ! 60
      1.0_r8                   & ! 61
    ]

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_dcmip21_l60

  subroutine hybrid_coord_dcmip31_l10(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(11)
    real(r8), intent(out) :: hybi(11)

    if (global_mesh%full_nlev /= 10 .and. proc%is_root()) then
      call log_error('nlev should be 10 in namelist!')
    end if

    hyai = [                  &
      0.2737592327457158_r8 , & !  1
      0.2574691274856134_r8 , & !  2
      0.2392257778961169_r8 , & !  3
      0.2188579122253837_r8 , & !  4
      0.1961834482057335_r8 , & !  5
      0.171008960410953_r8  , & !  6
      0.1431291236866448_r8 , & !  7
      0.1123261317013542_r8 , & !  8
      0.07836908962461686_r8, & !  9
      0.04101337989532572_r8, & ! 10
      0.0_r8                  & ! 11
    ]
    hybi = [                  &
      0.0_r8                , & !  1
      0.05950522689853417_r8, & !  2
      0.1261453522616924_r8 , & !  3
      0.2005460052239693_r8 , & !  4
      0.283372304056826_r8  , & !  5
      0.3753308018298088_r8 , & !  6
      0.4771715194731282_r8 , & !  7
      0.5896900697201707_r8 , & !  8
      0.7137298755603581_r8 , & !  9
      0.8501844869888955_r8 , & ! 10
      1.0_r8                  & ! 11
    ]

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_dcmip31_l10

  subroutine hybrid_coord_waccm_l70(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(71)
    real(r8), intent(out) :: hybi(71)

    if (global_mesh%full_nlev /= 70 .and. proc%is_root()) then
      call log_error('nlev should be 70 in namelist!')
    end if

    hyai = [                &
      4.50049997269275e-09, &
      7.42010008991656e-09, &
      1.22337002750328e-08, &
      2.01700007806949e-08, &
      3.32545013748131e-08, &
      5.48274989853326e-08, &
      9.03979966437873e-08, &
      1.49040005226198e-07, &
      2.45720002567396e-07, &
      4.05125007318929e-07, &
      6.67940014409396e-07, &
      1.10126495656004e-06, &
      1.81564996637462e-06, &
      2.99349994747899e-06, &
      4.96299981023185e-06, &
      8.15065141068771e-06, &
      1.34769998112461e-05, &
      2.23189999815077e-05, &
      3.67965003533754e-05, &
      6.0664999182336e-05 , &
      9.91565029835328e-05, &
      0.000157389993546531, &
      0.000238849999732338, &
      0.00034520000917837 , &
      0.000475134991575032, &
      0.000631804985459894, &
      0.000829154974780977, &
      0.00108274002559483 , &
      0.00140684994403273 , &
      0.00181885005440563 , &
      0.00233979988843203 , &
      0.00299505004659295 , &
      0.00381470005959272 , &
      0.00483444985002279 , &
      0.00609635002911091 , &
      0.00764934998005629 , &
      0.00955010019242764 , &
      0.0118640000000596  , &
      0.0146655002608895  , &
      0.0180380009114742  , &
      0.0220755003392696  , &
      0.0268824994564056  , &
      0.0325734987854958  , &
      0.0392730012536049  , &
      0.0471144989132881  , &
      0.0562404990196228  , &
      0.0668004974722862  , &
      0.0807014182209969  , &
      0.0949410423636436  , &
      0.11169321089983    , &
      0.131401270627975   , &
      0.154586806893349   , &
      0.181863352656364   , &
      0.17459799349308    , &
      0.166050657629967   , &
      0.155995160341263   , &
      0.14416541159153    , &
      0.130248308181763   , &
      0.113875567913055   , &
      0.0946138575673103  , &
      0.0753444507718086  , &
      0.0576589405536652  , &
      0.0427346378564835  , &
      0.0316426791250706  , &
      0.0252212174236774  , &
      0.0191967375576496  , &
      0.0136180268600583  , &
      0.00853108894079924 , &
      0.00397881818935275 , &
      0.00000000000000000 , &
      0.00000000000000000   &
    ]
    hybi = [                &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.000000000000000000, &
      0.0393548272550106  , &
      0.0856537595391273  , &
      0.140122056007385   , &
      0.204201176762581   , &
      0.279586911201477   , &
      0.368274360895157   , &
      0.47261056303978    , &
      0.576988518238068   , &
      0.672786951065063   , &
      0.753628432750702   , &
      0.813710987567902   , &
      0.848494648933411   , &
      0.881127893924713   , &
      0.911346435546875   , &
      0.938901245594025   , &
      0.963559806346893   , &
      0.985112190246582   , &
      1.000000000000000     &
    ]

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_waccm_l70

  subroutine hybrid_coord_cam_l32(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(33)
    real(r8), intent(out) :: hybi(33)

    if (global_mesh%full_nlev /= 32 .and. proc%is_root()) then
      call log_error('nlev should be 32 in namelist!')
    end if

    hyai = [                &
      0.00225523952394724 , & !  1
      0.00503169186413288 , & !  2
      0.0101579474285245  , & !  3
      0.0185553170740604  , & !  4
      0.0297346755951211  , & !  5
      0.0392730012536049  , & !  6
      0.0471144989132881  , & !  7
      0.0562404990196228  , & !  8
      0.0668004974722862  , & !  9
      0.0807014182209969  , & ! 10
      0.0949410423636436  , & ! 11
      0.11169321089983    , & ! 12
      0.131401270627975   , & ! 13
      0.154586806893349   , & ! 14
      0.181863352656364   , & ! 15
      0.17459799349308    , & ! 16
      0.166050657629967   , & ! 17
      0.155995160341263   , & ! 18
      0.14416541159153    , & ! 19
      0.130248308181763   , & ! 20
      0.113875567913055   , & ! 21
      0.0946138575673103  , & ! 22
      0.0753444507718086  , & ! 23
      0.0576589405536652  , & ! 24
      0.0427346378564835  , & ! 25
      0.0316426791250706  , & ! 26
      0.0252212174236774  , & ! 27
      0.0191967375576496  , & ! 28
      0.0136180268600583  , & ! 29
      0.00853108894079924 , & ! 30
      0.00397881818935275 , & ! 31
      0.00000000000000000 , & ! 32
      0.00000000000000000   & ! 33
    ]
    hybi = [                &
      0.00000000000000000 , & !  1
      0.00000000000000000 , & !  2
      0.00000000000000000 , & !  3
      0.00000000000000000 , & !  4
      0.00000000000000000 , & !  5
      0.00000000000000000 , & !  6
      0.00000000000000000 , & !  7
      0.00000000000000000 , & !  8
      0.00000000000000000 , & !  9
      0.00000000000000000 , & ! 10
      0.00000000000000000 , & ! 11
      0.00000000000000000 , & ! 12
      0.00000000000000000 , & ! 13
      0.00000000000000000 , & ! 14
      0.00000000000000000 , & ! 15
      0.0393548272550106  , & ! 16
      0.0856537595391273  , & ! 17
      0.140122056007385   , & ! 18
      0.204201176762581   , & ! 19
      0.279586911201477   , & ! 20
      0.368274360895157   , & ! 21
      0.47261056303978    , & ! 22
      0.576988518238068   , & ! 23
      0.672786951065063   , & ! 24
      0.753628432750702   , & ! 25
      0.813710987567902   , & ! 26
      0.848494648933411   , & ! 27
      0.881127893924713   , & ! 28
      0.911346435546875   , & ! 29
      0.938901245594025   , & ! 30
      0.963559806346893   , & ! 31
      0.985112190246582   , & ! 32
      1.0000000000000000    & ! 33
    ]

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_cam_l32

  subroutine hybrid_coord_cam_l30(p0, ptop, hyai, hybi)

    real(r8), intent(in) :: p0
    real(r8), intent(out) :: ptop
    real(r8), intent(out) :: hyai(31)
    real(r8), intent(out) :: hybi(31)

    if (global_mesh%full_nlev /= 30 .and. proc%is_root()) then
      call log_error('nlev should be 30 in namelist!')
    end if

    hyai = [                &
      0.002255239523947239, & !  1
      0.005031691864132881, & !  2
      0.01015794742852449 , & !  3
      0.01855531707406044 , & !  4
      0.03066912293434143 , & !  5
      0.04586747661232948 , & !  6
      0.0633234828710556  , & !  7
      0.08070141822099686 , & !  8
      0.09494104236364365 , & !  9
      0.1116932108998299  , & ! 10
      0.1314012706279755  , & ! 11
      0.1545868068933487  , & ! 12
      0.1818633526563644  , & ! 13
      0.1745979934930801  , & ! 14
      0.1660506576299667  , & ! 15
      0.1559951603412628  , & ! 16
      0.1441654115915298  , & ! 17
      0.1302483081817627  , & ! 18
      0.1138755679130554  , & ! 19
      0.09461385756731033 , & ! 20
      0.07534445077180862 , & ! 21
      0.05765894055366516 , & ! 22
      0.04273463785648346 , & ! 23
      0.03164267912507057 , & ! 24
      0.02522121742367744 , & ! 25
      0.01919673755764961 , & ! 26
      0.01361802686005831 , & ! 27
      0.008531088940799236, & ! 28
      0.003978818189352751, & ! 29
      0.000000000000000000, & ! 30
      0.000000000000000000  & ! 31
    ]

    hybi = [                &
      0.000000000000000000, & !  1
      0.000000000000000000, & !  2
      0.000000000000000000, & !  3
      0.000000000000000000, & !  4
      0.000000000000000000, & !  5
      0.000000000000000000, & !  6
      0.000000000000000000, & !  7
      0.000000000000000000, & !  8
      0.000000000000000000, & !  9
      0.000000000000000000, & ! 10
      0.000000000000000000, & ! 11
      0.000000000000000000, & ! 12
      0.000000000000000000, & ! 13
      0.0393548272550106  , & ! 14
      0.08565375953912735 , & ! 15
      0.1401220560073853  , & ! 16
      0.2042011767625809  , & ! 17
      0.2795869112014771  , & ! 18
      0.3682743608951569  , & ! 19
      0.4726105630397797  , & ! 20
      0.5769885182380676  , & ! 21
      0.6727869510650635  , & ! 22
      0.7536284327507019  , & ! 23
      0.8137109875679016  , & ! 24
      0.8484946489334106  , & ! 25
      0.8811278939247131  , & ! 26
      0.911346435546875   , & ! 27
      0.9389012455940247  , & ! 28
      0.9635598063468933  , & ! 29
      0.985112190246582   , & ! 30
      1.000000000000000000  & ! 31
    ]

    ptop = p0 * hyai(1)

  end subroutine hybrid_coord_cam_l30

end module hybrid_coord_test_mod
